<!-- project-page.component.html -->
<div class="projects-section section-black">
  
  <!-- Botón de volver -->
  <div class="container">
    <div class="back-container">
      <button 
        class="back-button bg-black-elements"
        (click)="goBack()"
        aria-label="Volver a proyectos"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m15 18-6-6 6-6"/>
        </svg>
        <span>Volver a proyectos</span>
      </button>
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="container">
    
    @if (isLoading) {
      <!-- Loading state -->
      <div class="loading-state">
        <div class="loading-spinner"></div>
        <p>Cargando proyecto...</p>
      </div>
    }
    
    @else if (error) {
      <!-- Error state -->
      <div class="error-state">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <h3>{{ error }}</h3>
        <p>Redirigiendo a la página de proyectos...</p>
      </div>
    }
    
    @else if (projectData) {
      <!-- Proyecto cargado -->
      
      <!-- Header del proyecto -->
      <div class="project-page-header">
        <h1 class="project-page-title">{{ projectData.title }}</h1>
        <div class="project-page-meta">
          <span class="project-page-category bg-black-elements">{{ projectData.category }}</span>
          <span class="project-page-year bg-black-elements">{{ projectData.year }}</span>
          
          <!-- Botón de compartir -->
          <button 
            class="share-button bg-black-elements"
            (click)="shareProject()"
            aria-label="Compartir proyecto"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
              <polyline points="16 6 12 2 8 6"></polyline>
              <line x1="12" y1="2" x2="12" y2="15"></line>
            </svg>
            <span>Compartir</span>
          </button>
        </div>
        <div class="project-line"></div>
      </div>

      <!-- Descripción corta -->
      <div class="project-description-short">
        <p>{{ projectData.description }}</p>
      </div>

      <!-- Carrusel 3D -->
      <div class="carousel-section">
        @if (projectData.images.length > 0) {
          <app-carousel
            [slides]="projectData.images"
            [autoRotate]="true"
            [rotationSpeed]="5000"
            [showControls]="true"
            [showIndicators]="true"
            [radius]="750"
            [width]="700"
            [height]="420"
          ></app-carousel>
        } @else {
          <div class="no-images bg-black-elements">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
            <p>No hay imágenes disponibles para este proyecto</p>
          </div>
        }
      </div>

      <!-- Información detallada -->
      <div class="project-details">
        
        <!-- Descripción completa -->
        <div class="detail-section">
          <h2 class="detail-title">Descripción del Proyecto</h2>
          <div class="detail-content">
            <p>{{ projectData.longDescription }}</p>
          </div>
        </div>

        <!-- Información de uso (credenciales) -->
        @if (usageInfo) {
          <div class="detail-section usage-section">
            <h2 class="detail-title">{{ usageInfo.title }}</h2>
            <div class="detail-content">
              
              <!-- Credenciales -->
              @if (usageInfo.credentials && usageInfo.credentials.length > 0) {
                <div class="credentials-section">
                  <h3 class="credentials-title">Credenciales de Acceso</h3>
                  <p class="credentials-description">Utiliza estas credenciales para probar la aplicación en diferentes roles:</p>
                  
                  <div class="credentials-grid">
                    @for (credential of usageInfo.credentials; track credential.role) {
                      <div class="credential-card bg-black-elements">
                        <div class="credential-header">
                          <div class="credential-role">{{ credential.role }}</div>
                          <button 
                            class="copy-credential-btn"
                            (click)="copyCredential(credential.username, credential.password)"
                            [attr.aria-label]="'Copiar credenciales de ' + credential.role"
                            title="Copiar credenciales"
                          >
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                          </button>
                        </div>
                        <div class="credential-details">
                          <div class="credential-field">
                            <span class="field-label">Usuario:</span>
                            <code class="field-value">{{ credential.username }}</code>
                          </div>
                          <div class="credential-field">
                            <span class="field-label">Contraseña:</span>
                            <code class="field-value">{{ credential.password }}</code>
                          </div>
                          @if (credential.description) {
                            <div class="credential-description">
                              {{ credential.description }}
                            </div>
                          }
                        </div>
                      </div>
                    }
                  </div>
                </div>
              }
              
              <!-- Instrucciones -->
              @if (usageInfo.instructions && usageInfo.instructions.length > 0) {
                <div class="instructions-section">
                  <h3 class="instructions-title">Instrucciones para Acceder</h3>
                  <ol class="instructions-list">
                    @for (instruction of usageInfo.instructions; track instruction; let i = $index) {
                      <li class="instruction-item">{{ instruction }}</li>
                    }
                  </ol>
                </div>
              }
            </div>
          </div>
        }

        <!-- Tecnologías con iconos -->
        @if (technologyIcons.length > 0) {
          <div class="detail-section">
            <h2 class="detail-title">Tecnologías Utilizadas</h2>
            <div class="project-tech">
              @for (tech of technologyIcons; track tech.name) {
                <div class="tech-item bg-black-elements">
                  <div class="tech-icon">
                    <img [src]="tech.icon" [alt]="tech.name" class="tech-logo">
                  </div>
                  <span class="tech-name">{{ tech.name }}</span>
                </div>
              }
            </div>
          </div>
        }

        <!-- Enlaces -->
        @if (projectData.liveUrl || projectData.githubUrl) {
          <div class="detail-section">
            <h2 class="detail-title">Enlaces del Proyecto</h2>
            <div class="project-links">
              @if (projectData.liveUrl) {
                <a 
                  [href]="projectData.liveUrl"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="project-link live-link bg-black-elements"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                    <polyline points="15 3 21 3 21 9"></polyline>
                    <line x1="10" y1="14" x2="21" y2="3"></line>
                  </svg>
                  <span>Ver proyecto en vivo</span>
                </a>
              }
              
              @if (projectData.githubUrl) {
                <a 
                  [href]="projectData.githubUrl"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="project-link github-link bg-black-elements"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                  </svg>
                  <span>Ver código en GitHub</span>
                </a>
              }
            </div>
          </div>
        }
      </div>

      <!-- Botón para volver arriba -->
      <div class="back-to-top-container">
        <button 
          class="back-to-top bg-black-elements"
          (click)="scrollToTop()"
          aria-label="Volver arriba"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m18 15-6-6-6 6"/>
          </svg>
          <span>Volver arriba</span>
        </button>
      </div>

    }

  </div>
</div>